{
    "componentChunkName": "component---src-templates-page-index-js",
    "path": "/2-aws-appsync-integration-with-react-native-part-2",
    "result": {"data":{"mdx":{"frontmatter":{"title":"AWS AppSync integration with React Native(part-2)","desc":"AppSync automatically updates the data in web and mobile apps in real time.","banner":{"sharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAB2HAAAdhwGP5fFlAAABlElEQVQoz02R227bMBBE/f9/lAJF2ue8FY7t2JYS62aJ1I0Ur7tLspDsFB0M9u1gdmd3lsIMKADX6XH24CikTTHGEEKIMaUEhNII5RaLWvtlscKC3imk1nrugHvkDlrrNa5w3HhrHeM9EgH5UXMuuvfs2Az1pHth5p0CYg4aqXPW35XhDgzSCgfSE0PwwzgpbTx6vvQVr3/8/pWVmXCTNGKFucfbOL8dz8UoagPcgMYICFN5dlPrAQylr0le2L2V/Sk/9ZJPeljsN1yJ5VTda6m4A/1IjsGyT9ucvVEpJe1du/R137y8/syrXD6TcV2bWc8sdMZ11uutsBgjOUNOpRi2wvyg+H1o9uf3oitGxddkTeFrFMeyOZTNoahvkzAhxhhnIduO3zs2ziKGSBFv7e3Px/6Uf+wvh2t5XZzcaQzFLK8tf7iYpaEQiISU/TjxYZyFRCQMULLyUlyvZZZVeV5/PgvrHn/a3K03P//8v4B8OzVZlW/OSlZIK3YuBAm0fFsC+vC8+Z9SShRQe2W8fhqUA/sXeGE3FnTYyjsAAAAASUVORK5CYII=","aspectRatio":1.9824561403508771,"src":"/static/f7b9f788864e148f60fc030e726c58e3/62b1f/2-aws-appsync-integration-with-react-native.png","srcSet":"/static/f7b9f788864e148f60fc030e726c58e3/e7519/2-aws-appsync-integration-with-react-native.png 113w,\n/static/f7b9f788864e148f60fc030e726c58e3/7e7e9/2-aws-appsync-integration-with-react-native.png 225w,\n/static/f7b9f788864e148f60fc030e726c58e3/62b1f/2-aws-appsync-integration-with-react-native.png 450w,\n/static/f7b9f788864e148f60fc030e726c58e3/e2e7f/2-aws-appsync-integration-with-react-native.png 675w,\n/static/f7b9f788864e148f60fc030e726c58e3/db955/2-aws-appsync-integration-with-react-native.png 900w,\n/static/f7b9f788864e148f60fc030e726c58e3/196bc/2-aws-appsync-integration-with-react-native.png 1278w","srcWebp":"/static/f7b9f788864e148f60fc030e726c58e3/b8a88/2-aws-appsync-integration-with-react-native.webp","srcSetWebp":"/static/f7b9f788864e148f60fc030e726c58e3/3a3bf/2-aws-appsync-integration-with-react-native.webp 113w,\n/static/f7b9f788864e148f60fc030e726c58e3/975bf/2-aws-appsync-integration-with-react-native.webp 225w,\n/static/f7b9f788864e148f60fc030e726c58e3/b8a88/2-aws-appsync-integration-with-react-native.webp 450w,\n/static/f7b9f788864e148f60fc030e726c58e3/761da/2-aws-appsync-integration-with-react-native.webp 675w,\n/static/f7b9f788864e148f60fc030e726c58e3/210c1/2-aws-appsync-integration-with-react-native.webp 900w,\n/static/f7b9f788864e148f60fc030e726c58e3/b40dc/2-aws-appsync-integration-with-react-native.webp 1278w","sizes":"(max-width: 450px) 100vw, 450px"}}}},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"AWS AppSync integration with React Native(part-2)\",\n  \"slug\": \"/2-aws-appsync-integration-with-react-native-part-2\",\n  \"date\": \"2018-09-15T00:00:00.000Z\",\n  \"desc\": \"AppSync automatically updates the data in web and mobile apps in real time.\",\n  \"cover\": {\n    \"img\": \"../../../photos/2-aws-appsync-integration-with-react-native.png\"\n  },\n  \"banner\": \"../../banners/2-aws-appsync-integration-with-react-native.png\",\n  \"tags\": [\"AWS\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"span\", {\n    className: \"first-letter\"\n  }, \"I\"), \"n last blog \", mdx(LinkPost, {\n    href: \"/1-aws-appsync-integration-with-react-native-part-1\",\n    name: \"Part 1\",\n    mdxType: \"LinkPost\"\n  }), \", We have completed AppSync setup.\"), mdx(\"p\", null, \"The next step is to link the data source that we have created to the app we are working on.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Go to the \", mdx(LinkPost, {\n    href: \"https://console.aws.amazon.com/appsync/home\",\n    name: \"AWS AppSync console\",\n    mdxType: \"LinkPost\"\n  }), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Choose your API.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"At the bottom of the page, choose React Native, and then download the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"AppSync.js\"), \" file.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Place the AppSync.js file into your \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"./src\"), \" directory.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add the requisite libraries to your project\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"$ yarn add react-apollo graphql-tag aws-sdk aws-appsync aws-appsync-react\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Edit the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"./android/app/src/main/AndroidManifest.xml\"), \" file. Add the following permission (in the same place as the other permissions)\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"<uses-permission android:name=\\u201Dandroid.permission.ACCESS_NETWORK_STATE\\u201D />\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Create the GraphQL documents. Create a new file ./src/graphql.js with the following contents. This block binds the GraphQL queries and mutations to function props on the React components.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"import gql from 'graphql-tag';\\nimport { graphql } from 'react-apollo';\\n\\nexport const ListAllNotes = gql`query ListAllNotes {\\n    allNote {\\n        noteId, title\\n    }\\n}`;\\n\\nexport const GetNote = gql`query GetNote($noteId:ID!) {\\n    getNote(noteId:$noteId) {\\n        noteId, title, content\\n    }\\n}`;\\n\\nexport const SaveNote = gql`mutation SaveNote($noteId:ID!,$title:String!,$content:String!) {\\n    putNote(noteId:$noteId, title:$title, content:$content) {\\n        noteId, title, content\\n    }\\n}`;\\n\\nexport const DeleteNote = gql`mutation DeleteNote($noteId:ID!) {\\n    deleteNote(noteId:$noteId) {\\n        noteId\\n    }\\n}`;\\n\\nexport const operations = {\\n    ListAllNotes: graphql(ListAllNotes, {\\n        options: {\\n            fetchPolicy: 'network-only'\\n        },\\n        props: ({ data }) => {\\n            return {\\n                loading: data.loading,\\n                notes: data.allNote\\n            };\\n        }\\n    }),\\n\\n     GetNote: graphql(GetNote, {\\n        options: props => {\\n            return {\\n                fetchPolicy: 'network-only',\\n                variables: { noteId: props.navigation.state.params.noteId }\\n            };\\n        },\\n        props: ({ data }) => {\\n            return {\\n                loading: data.loading,\\n                note: data.getNote\\n            }\\n        }\\n    }),\\n\\n    DeleteNote: graphql(DeleteNote, {\\n        options: {\\n            refetchQueries: [ { query: ListAllNotes } ]\\n        },\\n        props: props => ({\\n            deleteNote: (note) => {\\n                return props.mutate({\\n                    variables: note,\\n                    optimisticResponse: {\\n                        deleteNote: { ...note, __typename: 'Note' }\\n                    }\\n                })\\n            }\\n        })\\n    }),\\n\\n    SaveNote: graphql(SaveNote, {\\n        options: {\\n            refetchQueries: [ { query: ListAllNotes } ]\\n        },\\n        props: props => ({\\n            saveNote: (note) => {\\n                return props.mutate({\\n                    variables: note,\\n                    optimisticResponse: {\\n                        putNote: { ...note, __typename: 'Note' }\\n                    }\\n                })\\n            }\\n        })\\n    })\\n};\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Update App.js to instantiate the AppSync connection. Adjust the imports as follows:\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// import { Provider } from 'react-redux';\\n// import { PersistGate } from 'redux-persist/es/integration/react';\\n// import { persistor, store } from './src/redux/store';\\n\\nimport AWSAppSyncClient from 'aws-appsync';\\nimport { Rehydrated } from 'aws-appsync-react';\\nimport { ApolloProvider } from 'react-apollo';\\nimport appsyncConfig from './src/config/AppSync';\\n\\nconst appsyncClient = new AWSAppSyncClient({\\n  url: appsyncConfig.graphqlEndpoint,\\n  region: appsyncConfig.region,\\n  auth: { type: appsyncConfig.authenticationType, apiKey: appsyncConfig.apiKey }\\n});\\n\")), mdx(\"p\", null, \"In above snippet, removing redux integration from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"App.js\"), \" file. Here, we are using GraphQL, so we are no longer needed redux store. React Apollo allows to fetch data from GraphQL server.  Apollo Provider provides the React Apollo functionality to all the other components in the application without passing it explicitly.  Rehydrated in aws-appsync-react will wait until the application cache has been read and is ready to use in the app before rendering the app. By default, this just shows some loading text.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Replace the return value from the App component with the following:\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"return (\\n  <ApolloProvider client={appsyncClient}>\\n    <Rehydrated>\\n      <Navigator/>\\n    </Rehydrated>\\n  </ApolloProvider>\\n);\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Update the screens to remove Redux connectivity in ./src/screens/NoteListScreen.js and ./src/screens/NoteDetailsScreen.js  Comment out the Redux imports and replace them with AppSync imports (at the top of each file)  Comment out the mapStateToProps, mapDispatchToProps, and connect blocks (at the bottom of each file, marked by //BEGIN-REDUX and //END-REDUX).\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// BEGIN-REDUX\\n// import { connect } from 'react-redux';\\n// import actions from '../redux/actions';\\n// END-REDUX\\n\\n// BEGIN APPSYNC\\nimport { compose } from 'react-apollo';\\nimport * as GraphQL from '../graphql';\\n// END APPSYNC\\n\")), mdx(\"p\", null, \"Here, I have commented connect and actions as we are no longer needed this. Importing Compose, which easily group all of the data requirements together. If we don\\u2019t use compose, then by default we receive a prop called mutate for mutation and receive data for query.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add the following code block to the bottom of the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"./src/screens/NoteListScreen.js\"), \" file, just before the export default line\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const NoteListScreen = compose(\\n  GraphQL.operations.ListAllNotes,\\n  GraphQL.operations.DeleteNote\\n)(NoteList);\\n\\nexport default NoteDetailsScreen;\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Similarly, add the following code block to the bottom of the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"./src/screens/NoteDetailsScreen.js\"), \" file\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const NoteDetailsScreen = compose(\\n  GraphQL.operations.GetNote,\\n  GraphQL.operations.SaveNote\\n)(NoteDetails);\\n\\nexport default NoteListScreen;\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Run the application. Use the app to add and delete some notes.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"..src/screens/NoteListScreen.js\"), \", for deleting the notes we have to make some changes:\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"onDeleteNote(item) {\\n  this.props.deleteNote(item);\\n}\\n\\nconst mapDispatchToProps = (dispatch) => {\\n  return {\\n    deleteNote: ({ noteId }) => dispatch(actions.notes.deleteNote({ noteId }))\\n  };\\n};\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Go to the \", mdx(LinkPost, {\n    href: \"https://console.aws.amazon.com/dynamodb/home\",\n    name: \"DynamoDB console\",\n    mdxType: \"LinkPost\"\n  }), \" and check the table for your connection. You should see a representation of the current set of notes.\")), mdx(\"h3\", null, \"Offline access \\uD83E\\uDD37\\uD83C\\uDFFB\\u200D\\u2640\\uFE0F\"), mdx(\"p\", null, \"We can move from online access to offline access by changing the fetchPolicy within the operations block of ./src/graphql.js from \\u2018network-only\\u2019 (which is to say \\u2013 it always query the backend server) to one of the other possible options:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"mark\", null, \"\\u2018cache-first\\u2019\"), \" always returns data from the cache if the data is available. Data is fetched from the network only if a cached result isn\\u2019t available.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"mark\", null, \"\\u2018cache-and-network\\u2019\"), \" always queries the network for data, regardless of whether the full data is in your cache. It returns the cache if it\\u2019s available. This option is for returning data quickly, but keeping the cached data consistent with the server (note that it might result in some UI \\u201Cflipping of data\\u201D issues).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"mark\", null, \"\\u2018network-only\\u2019\"), \" ignores the cache.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"mark\", null, \"\\u2018cache-only\\u2019\"), \" ignores the network.\")), mdx(\"h2\", null, \"Reference \\uD83E\\uDDD0\"), mdx(LinkPost, {\n    href: \"https://docs.aws.amazon.com/appsync/latest/devguide/welcome.html\",\n    name: \"https://docs.aws.amazon.com/appsync/latest/devguide/welcome.html\",\n    mdxType: \"LinkPost\"\n  }));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"slug":"/2-aws-appsync-integration-with-react-native-part-2"}},
    "staticQueryHashes": ["1691836396"]}